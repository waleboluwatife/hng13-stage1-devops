=== Starting HNG13 Stage 1 Deployment ===
Logging to deploy_20251022_163107.log

[INFO] Repo exists. Pulling latest changes...
From https://github.com/waleboluwatife/hng13-stage1-devops
 * branch            main       -> FETCH_HEAD
Updating e275fbe..98e3ef7
Fast-forward
 deploy.sh           | 2 +-
 hng13-stage1-devops | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
[INFO] Repository ready.
[INFO] Testing SSH connectivity...
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
SSH OK
[INFO] Preparing remote environment...
Pseudo-terminal will not be allocated because stdin is not a terminal.
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
   ,     #_
   ~\_  ####_        Amazon Linux 2023
  ~~  \_#####\
  ~~     \###|
  ~~       \#/ ___   https://aws.amazon.com/linux/amazon-linux-2023
   ~~       V~' '->
    ~~~         /
      ~~._.   _/
         _/ _/
       _/m/'
Last metadata expiration check: 1 day, 18:11:13 ago on Mon Oct 20 21:20:03 2025.
Dependencies resolved.
Nothing to do.
Complete!
Last metadata expiration check: 1 day, 18:11:14 ago on Mon Oct 20 21:20:03 2025.
Package docker-25.0.13-1.amzn2023.0.1.x86_64 is already installed.
Package nginx-1:1.28.0-1.amzn2023.0.2.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!
Docker version 25.0.13, build 0bab007
Docker Compose version v2.27.0
nginx version: nginx/1.28.0
[INFO] Transferring project to remote server...
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
[INFO] Deploying Docker container...
Pseudo-terminal will not be allocated because stdin is not a terminal.
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
   ,     #_
   ~\_  ####_        Amazon Linux 2023
  ~~  \_#####\
  ~~     \###|
  ~~       \#/ ___   https://aws.amazon.com/linux/amazon-linux-2023
   ~~       V~' '->
    ~~~         /
      ~~._.   _/
         _/ _/
       _/m/'
[REMOTE] Using docker-compose...
time="2025-10-22T15:31:29Z" level=warning msg="/home/ec2-user/hng13-stage1-deploy/docker-compose.yml: `version` is obsolete"
 Container hng_stage1_web  Stopping
 Container hng_stage1_web  Stopped
 Container hng_stage1_web  Removing
 Container hng_stage1_web  Removed
 Network hng13-stage1-deploy_default  Removing
 Network hng13-stage1-deploy_default  Removed
time="2025-10-22T15:31:30Z" level=warning msg="/home/ec2-user/hng13-stage1-deploy/docker-compose.yml: `version` is obsolete"
 Network hng13-stage1-deploy_default  Creating
 Network hng13-stage1-deploy_default  Created
 Container hng_stage1_web  Creating
 Container hng_stage1_web  Created
 Container hng_stage1_web  Starting
 Container hng_stage1_web  Started
[INFO] Configuring NGINX reverse proxy...
Pseudo-terminal will not be allocated because stdin is not a terminal.
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
   ,     #_
   ~\_  ####_        Amazon Linux 2023
  ~~  \_#####\
  ~~     \###|
  ~~       \#/ ___   https://aws.amazon.com/linux/amazon-linux-2023
   ~~       V~' '->
    ~~~         /
      ~~._.   _/
         _/ _/
       _/m/'
nginx: [warn] conflicting server name "_" on 0.0.0.0:80, ignored
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
[INFO] Validating deployment...
Pseudo-terminal will not be allocated because stdin is not a terminal.
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
   ,     #_
   ~\_  ####_        Amazon Linux 2023
  ~~  \_#####\
  ~~     \###|
  ~~       \#/ ___   https://aws.amazon.com/linux/amazon-linux-2023
   ~~       V~' '->
    ~~~         /
      ~~._.   _/
         _/ _/
       _/m/'
===== Docker containers =====
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES
f587681e980f   nginx:latest   "/docker-entrypoint.…"   6 seconds ago   Up 5 seconds   0.0.0.0:8080->80/tcp, :::8080->80/tcp   hng_stage1_web
===== Local NGINX test =====
HTTP/1.1 200 OK
Server: nginx/1.28.0
Date: Wed, 22 Oct 2025 15:31:37 GMT
Content-Type: text/html
Content-Length: 530
Last-Modified: Thu, 16 Oct 2025 16:07:26 GMT
Connection: keep-alive
ETag: "68f1183e-212"
Accept-Ranges: bytes

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0   530    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0

✅ Deployment completed successfully!
Visit: http://51.21.190.241/
Log file: deploy_20251022_163107.log
